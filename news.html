<!DOCTYPE html>
<html lang="en">
    

<head>
        
        <meta charset="utf-8">
        <title>Love of Quant</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="img/assets/favicon.png" rel="icon" type="image/png">
        <link href="css/init.css" rel="stylesheet" type="text/css">
        <link href="css/ion-icons.min.css" rel="stylesheet" type="text/css">
        <link href="css/etline-icons.min.css" rel="stylesheet" type="text/css">
        <link href="css/theme.css" rel="stylesheet" type="text/css">
        <link href="css/custom.css" rel="stylesheet" type="text/css">
        <link href="css/colors/purple.css" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRaleway:400,100,200,300%7CHind:400,300" rel="stylesheet" type="text/css">
        

        <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.4/css/jquery.dataTables.min.css">
        <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.25/css/jquery.dataTables.css">
        <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/2.2.2/css/buttons.dataTables.min.css">


        <script src="https://code.jscharting.com/latest/jscharting.js"></script>
        <script type="text/javascript" src="https://code.jscharting.com/latest/modules/types.js"></script>
        <script type="text/javascript" src="https://code.jscharting.com/latest/modules/toolbar.js"></script>    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.1/papaparse.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/1.0.3/jquery.csv.min.js"></script>  


        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>

        <script type="text/javascript" src="https://cdn.datatables.net/v/dt/jq-3.6.0/jszip-2.5.0/dt-1.11.4/af-2.3.7/b-2.2.2/b-colvis-2.2.2/b-html5-2.2.2/datatables.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"></script>

        <script src="https://code.jscharting.com/latest/jscharting.js"></script>
        <script type="text/javascript" src="https://code.jscharting.com/latest/modules/types.js"></script>
        <script type="text/javascript" src="https://code.jscharting.com/latest/modules/toolbar.js"></script>


  
        <script src="https://code.jscharting.com/latest/jscharting.js"></script>



    </head>
    <body>



        <!-- Start Header -->
        <nav class="navbar nav-down" data-fullwidth="true" data-menu-style="light" data-animation="shrink">
                                        <!-- Styles: light, dark, transparent, transparent-to-dark | Animation: hiding, shrink -->
            <div class="container">

                <div class="navbar-header">
                    <div class="container">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar top-bar"></span>
                            <span class="icon-bar middle-bar"></span>
                            <span class="icon-bar bottom-bar"></span>
                        </button>
                    
                    </div>
                </div>

                <div id="navbar" class="navbar-collapse collapse">
                    <div class="container">
                        <ul class="nav navbar-nav menu-center">

                            <!-- Each section must have corresponding ID ( #hero -> id="hero" ) -->
                            <li><a href="index.html" target="_top">Home</a></li>
                            <li><a href="index.html#about">About</a></li>
                            <li><a href="index.html#table">Stock News</a></li>
                            <li><a href="index.html#table2">Wall Street Journal</a></li>
                            <li><a href="index.html#table4">Bloomberg</a></li>
                            <li><a href="index.html#table3">Crypto News</a></li>
                            <li><a href="index.html#table5">FMP Articles</a></li>
                            <li class="dropdown megamenu vos">
                                <a class="dropdown-toggle">Data<i class="ion-ios-arrow-down"></i></a>
                                <ul class="dropdown-menu fullwidth">
                                    <li class="megamenu-content withdesc">
                                        <div class="col-md-3 mg-col">
                                            <ul>
                                                <li><a href="stocks.html" target="_top">Equities</a></li>
                                                <li><a href="gdp.html" target="_top">GDP</a></li>
                                                <li><a href="umcsi.html" target="_top">UMCSI</a></li>
                                                <li><a href="housing.html" target="_top">Housing</a></li>
                                                <li><a href="screener.html" target="_top">Stock Screener</a></li>
                                                <li><a href="black_candle.html" target="_top">Secrets of the Candlestick</a></li>
                                            </ul>
                                        </div>
                                        <div class="col-md-3 mg-col">
                                            <ul>
                                                <li><a href="ism.html" target="_top">ISM Manufacturing</a></li>
                                                <li><a href="ism-services.html" target="_top">ISM Services</a></li>
                                                <li><a href="ism-heatmaps.html" target="_top">ISM Heatmaps</a></li>
                                                <li><a href="stock_dash.html" target="_top">Stock Dashboard</a></li>
                                                <li><a href="bitmex_calc.html" target="_top">Bitmex Crypto Calculator</a></li>
                                                <li><a href="news.html">News</a></li>
                                            </ul>
                                        </div>
                                    </li>
                                </ul>
                            </li>
                            
                        </ul>
                        
                    </div>
                </div>
            </div>
        </nav>
        <!-- End Header -->


        <!-- Project -->
        <section class="pt140 pb50">

            <script>

                var column_list2 = [
                                        { title: "Ticker", "data": "symbol" },
                                        { title: "Date", "data": "publishedDate"},
                                        { title: "Source Name", "data": "site" },
                                        { title: "News", "data": "text", "width": "50%" },
                                        { title: "Link", "data": "url"}
                                    ,
                                    ];

                var table = $('#table').DataTable();
                var urlstring = "https://financialmodelingprep.com/api/v3/stock_news?limit=50&apikey=c01b3c8e189822588988574a0c3957dd"

                
                    table.destroy();
                      
                    $(document).ready(function () {
                        table = $('#table').DataTable({
                            retrieve: true,
                            
                            
                            ajax: {
                                url: urlstring,
                                dataSrc: ""
                            },
                            pageLength: 5,
                            columns: column_list2,
                            buttons: [ 'excel' ]

                        });
                        table.buttons().container().insertBefore( '#table_filter' );
                        

                        setInterval( function () {
                        //table.ajax.reload(); // user paging is not reset on reload


                        }, 30000 );

                    });
                
                ///////////////////////////////////////
                    var column_list5 = [
                                        { title: "Ticker", "data": "tickers" },
                                        { title: "Date", "data": "date", "render": function(publishedAt) {

                                            const date = new Date(publishedAt).toLocaleDateString("en-US");
                                            const time = new Date(publishedAt).toLocaleTimeString("en-US");

                                            return date + ' ' + time;} },
                                        { title: "Title", "data": "title" },
                                       // { title: "Source Name", "data": "site" },
                                        { title: "News", "data": "content", "width": "50%" },
                                        { title: "Link", "data": "link"}
                                    ,
                                    ];

                var table5 = $('#table5').DataTable();
                var urlstring5 = "https://financialmodelingprep.com/api/v3/fmp/articles?page=0&size=100&apikey=c01b3c8e189822588988574a0c3957dd"

                
                    table5.destroy();
                      
                    $(document).ready(function () {
                        table5 = $('#table5').DataTable({
                            retrieve: true,
                            "ajax": {
                                "url": urlstring5,
                                "dataSrc": "content"
                            },
                            "pageLength": 5,
                            "columns": column_list5,
                            buttons: [ 'excel' ]
                        });

                        table5.buttons().container()
                                    .insertBefore( '#table5_filter' );

                        setInterval( function () {
                        table5.ajax.reload(); // user paging is not reset on reload
                        

                        }, 30000 );

                        //table5.buttons().container()
                         //           .insertBefore( '#table5_filter' );

                    });

                ////////////////////////////////        


                var table2 = $('#table2').DataTable();
                var urlstring2 = 'https://newsapi.org/v2/everything?domains=wsj.com&sortBy=popularity&apiKey=b9fc211659cb431aabc01c5b5f5ccd4e'
                var urlstring2 = "http://api.allorigins.win/get?url=https%3A//newsapi.org/v2/everything%3Fdomains%3Dwsj.com%26sortBy%3Dpopularity%26apiKey%3Db9fc211659cb431aabc01c5b5f5ccd4e&callback=?"

                var url = "https://newsapi.org/v2/everything?domains=wsj.com&pageSize=50&sortBy=publishedAt&apiKey=b9fc211659cb431aabc01c5b5f5ccd4e"

                var urlbit = "https://newsapi.org/v2/everything?q=(bitcoin OR crypto)&pageSize=50&sortBy=publishedAt&apiKey=b9fc211659cb431aabc01c5b5f5ccd4e"

                var urlbb = "https://newsapi.org/v2/everything?domains=bloomberg.com&pageSize=50&sortBy=publishedAt&apiKey=b9fc211659cb431aabc01c5b5f5ccd4e"

            var url1 = `https://api.allorigins.win/get?url=${encodeURIComponent(url)}`
            var url2 = `https://api.allorigins.win/get?url=${encodeURIComponent(urlbit)}`
            var url3 = `https://api.allorigins.win/get?url=${encodeURIComponent(urlbb)}`
            const urls = [
              url1,
              url2,
              url3,
            ]

            
            


            async function fetchData(urlstrings) {
              try {
                const response = await Promise.all(
                  urlstrings.map(url => fetch(url).then(res => res.json()))
                )
                
                var jsonstring = response[0].contents;
                const jsonobj = JSON.parse(jsonstring);

                var jsonstring2 = response[1].contents;
                const jsonobj2 = JSON.parse(jsonstring2);

                var jsonstring3 = response[2].contents;
                const jsonobj3 = JSON.parse(jsonstring3);

                  $(document).ready(function() {
                  
                  //console.log(data);
                  var column_list = [
                   { title: "Time", "render": function(publishedAt) {

                    const date = new Date(publishedAt).toLocaleDateString("en-US");
                        const time = new Date(publishedAt).toLocaleTimeString("en-US");

                        return date + ' ' + time;}},
                    //{ title: "author"},
                    { title: "title", "width": "25%"},
                    { title: "description", "width": "50%"},
                    //{ title: "content"},
                    { title: "Link", "url": "url"
                                    },

                  ];

                   let data = [];

                    jsonobj.articles.forEach((val, idx) => { 

                      data.push({publishedAt: jsonobj.articles[idx]["publishedAt"],title: jsonobj.articles[idx]["title"],description: jsonobj.articles[idx]["description"],url: jsonobj.articles[idx]["url"]  });

                      //console.log(jsonobj.articles[idx]);
                    });

                    var data_val = data.map(el => Object.values(el));

                    var currentDate = new Date()
                    var day = currentDate.getDate()
                    var month = currentDate.getMonth() + 1
                    var year = currentDate.getFullYear()
                    var time = currentDate.getHours() + "" + currentDate.getMinutes();

                    var timename = year + "-" + month + "-" + day + "_" + time;

                    var dataTables = $('#table2').DataTable ({
                          retrieve: true,
                          //paging: false,
                          data:data_val,
                          pageLength: 5,
                          columns : column_list,
                          buttons: [{
                                    extend: 'excelHtml5',
                                    title: 'wsj_' + timename
                                    }]




                      });

                    dataTables.buttons().container()
                                    .insertBefore( '#table2_filter' );


                   let data2 = [];

                    jsonobj2.articles.forEach((val, idx) => { 

                      data2.push({publishedAt: jsonobj2.articles[idx]["publishedAt"],title: jsonobj2.articles[idx]["title"],description: jsonobj2.articles[idx]["description"],url: jsonobj2.articles[idx]["url"]  });

                      //console.log(jsonobj.articles[idx]);
                    });

                    var data_val2 = data2.map(el => Object.values(el));


                    var dataTables2 = $('#table3').DataTable ({
                          retrieve: true,
                          //paging: false,
                          data:data_val2,
                          pageLength: 5,
                          columns : column_list,
                          buttons: [ 'excel' ]
                      });

                    dataTables2.buttons().container()
                                    .insertBefore( '#table3_filter' );

                    // BLOOMBERG.COM
                   let data3 = [];

                    jsonobj3.articles.forEach((val, idx) => { 

                      data3.push({publishedAt: jsonobj3.articles[idx]["publishedAt"],title: jsonobj3.articles[idx]["title"],description: jsonobj3.articles[idx]["description"],url: jsonobj3.articles[idx]["url"]  });

                      //console.log(jsonobj.articles[idx]);
                    });

                    var data_val3 = data3.map(el => Object.values(el));


                    var dataTables3 = $('#table4').DataTable ({
                          retrieve: true,
                          //paging: false,
                          data:data_val3,
                          pageLength: 5,
                          columns : column_list,
                          buttons: [ 'excel' ]
                      });

                    dataTables3.buttons().container()
                                    .insertBefore( '#table4_filter' );

                      
              });

              } catch (error) {
                console.log("Error", error)
              }
            }
            
            fetchData(urls);

            setInterval( function () {
                fetchData(urls);
                }, 30000 );

            </script>

            <div class="container">

            </div>

            <table id="table" class="display" width="80%"> <caption style="text-align:center;font-size:40px"><strong>News</strong></caption> </table> 
            <table id="table2" class="display" width="80%"> <caption style="text-align:center;font-size:40px"><strong>Wall Street Journal</strong></caption> </table>

            <table id="table3" class="display" width="80%"> <caption style="text-align:center;font-size:40px"><strong>Crypto News</strong></caption> </table>  
            <table id="table4" class="display" width="80%"> <caption style="text-align:center;font-size:40px"><strong>Bloomberg News</strong></caption> </table>   
            
            <table id="table5" class="display" width="80%"> <caption style="text-align:center;font-size:40px"><strong>Financial Modelling Prep Articles</strong></caption> </table>  


        </section>
        <!-- End Project -->


        <!-- Start Footer -->
        <footer id="footer" class="footer style-1 dark">

            <!-- Back To Top Button -->
            <span><a class="scroll-top"><i class="ion-chevron-up"></i></a></span>

        </footer>
        <!-- End Footer -->

    </body>

</html>
